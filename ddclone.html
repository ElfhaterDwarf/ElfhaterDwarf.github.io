
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∏—Ç–≤–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            text-align: center;
        }
        #battleArea {
            display: none;
            margin-top: 20px;
        }
        .character {
            display: inline-block;
            margin: 20px;
            padding: 10px;
            border: 2px solid #333;
            border-radius: 10px;
            background-color: #fff;
            cursor: pointer;
        }
        .selected {
            background-color: #e0e0ff;
            border-color: #000;
        }
        .highlight {
            color: #ff0000;
            font-weight: bold;
        }
        .health {
            font-size: 16px;
            font-weight: bold;
            margin-top: 10px;
        }
        .attack-button {
            margin-top: 20px;
            display: none;
        }
        #roundCounter {
            font-size: 24px;
            font-weight: bold;
            margin: 20px;
        }
    </style>
</head>
<body>
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±–∏—Ç–≤—É –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π!</h1>
    <button id="startButton">–ù–∞—á–∞—Ç—å –±–∏—Ç–≤—É</button>
    <div id="battleArea">
        <div id="roundCounter">–†–∞—É–Ω–¥: 0</div>
        <div id="playerCharacters">
            <h3>–ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –∏–≥—Ä–æ–∫–∞</h3>
            <div class="character" id="hero1">
                <h4>–ü–µ—Ä—Å–æ–Ω–∞–∂ 1 (–°–∫–æ—Ä–æ—Å—Ç—å: <span id="hero1Speed">0</span>) <span class="highlight" id="highlightHero1"></span></h4>
                <div class="health">–ó–¥–æ—Ä–æ–≤—å–µ: <span id="hero1Health">100</span></div>
            </div>
            <div class="character" id="hero2">
                <h4>–ü–µ—Ä—Å–æ–Ω–∞–∂ 2 (–°–∫–æ—Ä–æ—Å—Ç—å: <span id="hero2Speed">0</span>) <span class="highlight" id="highlightHero2"></span></h4>
                <div class="health">–ó–¥–æ—Ä–æ–≤—å–µ: <span id="hero2Health">100</span></div>
            </div>
            <div class="character" id="hero3">
                <h4>–ü–µ—Ä—Å–æ–Ω–∞–∂ 3 (–°–∫–æ—Ä–æ—Å—Ç—å: <span id="hero3Speed">0</span>) <span class="highlight" id="highlightHero3"></span></h4>
                <div class="health">–ó–¥–æ—Ä–æ–≤—å–µ: <span id="hero3Health">100</span></div>
            </div>
        </div>
        <div id="enemyCharacters">
            <h3>–ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞</h3>
            <div class="character" id="enemy1">
                <h4>–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫ 1 (–°–∫–æ—Ä–æ—Å—Ç—å: <span id="enemy1Speed">0</span>) <span class="highlight" id="highlightEnemy1"></span></h4>
                <div class="health">–ó–¥–æ—Ä–æ–≤—å–µ: <span id="enemy1Health">100</span></div>
            </div>
            <div class="character" id="enemy2">
                <h4>–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫ 2 (–°–∫–æ—Ä–æ—Å—Ç—å: <span id="enemy2Speed">0</span>) <span class="highlight" id="highlightEnemy2"></span></h4>
                <div class="health">–ó–¥–æ—Ä–æ–≤—å–µ: <span id="enemy2Health">100</span></div>
            </div>
            <div class="character" id="enemy3">
                <h4>–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫ 3 (–°–∫–æ—Ä–æ—Å—Ç—å: <span id="enemy3Speed">0</span>) <span class="highlight" id="highlightEnemy3"></span></h4>
                <div class="health">–ó–¥–æ—Ä–æ–≤—å–µ: <span id="enemy3Health">100</span></div>
            </div>
        </div>
        <button class="attack-button" id="attackButton" onclick="attack()">–ê—Ç–∞–∫–æ–≤–∞—Ç—å</button>
        <button class="attack-button" id="provokeButton">–ü—Ä–æ–≤–æ—Ü–∏—Ä–æ–≤–∞—Ç—å</button>
        <button class="attack-button" id="prepareButton">–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∞—Ç–∞–∫—É</button>
    </div>
    <script>
        const startButton = document.getElementById('startButton');
        const battleArea = document.getElementById('battleArea');
        let selectedTarget = null;
        let turnOrder = [];
        let currentTurnIndex = 0;
        let round = 0;

        const enemyNames = ["–ë–∞–Ω–¥–∏—Ç", "–°–æ–±–∞–∫–∞", "–ì—É–ª—å", "–ê–Ω–∏–º–µ—à–Ω–∏–∫", "–ó–ª–æ–¥–µ–π –ë–æ –°–∏–Ω–Ω", "–ë–∏—Ç–∞—Ä–¥–∏–∫", "–°–ø–∞–Ω—á –ë–æ–±"];
        const playerPrefixes = ["–ì–µ—Ä–æ–π", "–í–æ–∏–Ω", "–ú–∞–≥", "–£–±–∏–π—Ü–∞", "–°—Ç—Ä–µ–ª–æ–∫", "–¢–∞–Ω–∫"];

        startButton.addEventListener('click', function() {
            startButton.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
            battleArea.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±–ª–∞—Å—Ç—å –±–∏—Ç–≤—ã
            initializeCharacters(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
            calculateTurnOrder(); // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–æ—Ä—è–¥–æ–∫ —Ö–æ–¥–æ–≤
            highlightCurrentTurn(); // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        });

        function getRandomName() {
            return playerPrefixes[Math.floor(Math.random() * playerPrefixes.length)] + " " + Math.floor(Math.random() * 100);
        }

        function initializeCharacters() {
            for (let i = 1; i <= 3; i++) {
                const speed = Math.floor(Math.random() * 6) + 1;
                document.getElementById("hero" + i + "Speed").innerText = speed;
                document.getElementById("hero" + i).querySelector("h4").firstChild.nodeValue = getRandomName() + " (–°–∫–æ—Ä–æ—Å—Ç—å: " + speed + ")";
                turnOrder.push({ id: 'hero' + i, speed: speed, isPlayer: true, health: 100, prepared: false, isDead: false });
            }
            for (let i = 1; i <= 3; i++) {
                const speed = Math.floor(Math.random() * 6) + 1;
                document.getElementById("enemy" + i + "Speed").innerText = speed;
                document.getElementById("enemy" + i).querySelector("h4").firstChild.nodeValue = enemyNames[Math.floor(Math.random() * enemyNames.length)] + " (–°–∫–æ—Ä–æ—Å—Ç—å: " + speed + ")";
                turnOrder.push({ id: 'enemy' + i, speed: speed, isPlayer: false, health: 100, prepared: false, isDead: false });
            }
        }

        function calculateTurnOrder() {
            turnOrder.sort((a, b) => b.speed - a.speed);
            turnOrder = turnOrder.filter(c => !c.isDead); // –ò—Å–∫–ª—é—á–∞–µ–º –º—ë—Ä—Ç–≤—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –ø—Ä–∏ –ø–æ–¥—Å—á–µ—Ç–µ –ø–æ—Ä—è–¥–∫–∞ —Ö–æ–¥–æ–≤ 
        }

        function highlightCurrentTurn() {
            const characters = document.querySelectorAll('.character');
            characters.forEach(character => {
                character.classList.remove('highlight');
                const highlightElement = document.getElementById("highlight" + character.id.charAt(0).toUpperCase() + character.id.slice(1));
                highlightElement.innerText = ''; // –£–±–∏—Ä–∞–µ–º –∑–≤—ë–∑–¥–æ—á–∫—É
            });
            const currentCharacter = turnOrder[currentTurnIndex];
            const characterElement = document.getElementById(currentCharacter.id);
            characterElement.classList.add('highlight');
            const highlightElement = document.getElementById("highlight" + currentCharacter.id.charAt(0).toUpperCase() + currentCharacter.id.slice(1));
            highlightElement.innerText = '*'; // –î–æ–±–∞–≤–ª—è–µ–º –∑–≤—ë–∑–¥–æ—á–∫—É

            if (currentCharacter.isPlayer) {
                const enemies = turnOrder.filter(c => !c.isPlayer);
                enemies.forEach(enemy => {
                    const enemyElement = document.getElementById(enemy.id);
                    enemyElement.onmouseover = () => enemyElement.classList.add('selected');
                    enemyElement.onmouseout = () => enemyElement.classList.remove('selected');
                    enemyElement.onclick = () => selectTarget(enemy.id, enemyElement);
                });
                document.getElementById('attackButton').style.display = 'block'; 
                document.getElementById('provokeButton').style.display = 'block'; 
                document.getElementById('prepareButton').style.display = 'block'; 
            } else {
                setTimeout(AIAttack, 1000); // AI –¥–µ–ª–∞–µ—Ç –∞—Ç–∞–∫—É —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É
            }
        }

        function AIAttack() {
            const currentCharacter = turnOrder[currentTurnIndex];
            const enemies = turnOrder.filter(c => c.isPlayer && c.health > 0 && !c.isDead); 
            const target = enemies[Math.floor(Math.random() * enemies.length)]; // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞
            attackCharacter(currentCharacter.id, target.id);
            nextTurn(); // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ö–æ–¥—É
        }

        function selectTarget(targetId, element) {
            const characters = document.querySelectorAll('.character');
            characters.forEach(character => {
                character.classList.remove('selected');
            });
            element.classList.add('selected');
            selectedTarget = targetId;
        }

        function attack() {
            if (selectedTarget) {
                const currentCharacter = turnOrder[currentTurnIndex];
                attackCharacter(currentCharacter.id, selectedTarget);
                currentCharacter.prepared = false; 
                nextTurn(); // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ö–æ–¥—É
            }
        }

        function provoke() {
            const currentCharacter = turnOrder[currentTurnIndex];
            currentCharacter.prepared = true; // –ü–µ—Ä—Å–æ–Ω–∞–∂ –≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ –∞—Ç–∞–∫–µ
            nextTurn(); // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ö–æ–¥—É
        }

        function prepareAttack() {
            const currentCharacter = turnOrder[currentTurnIndex];
            currentCharacter.prepared = true; // –ü–µ—Ä—Å–æ–Ω–∞–∂ –≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ —Å–∏–ª—å–Ω–æ–π –∞—Ç–∞–∫–µ
            nextTurn(); // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ö–æ–¥—É
        }

        function attackCharacter(attackerId, defenderId) {
            const defenderHealth = document.getElementById(defenderId + 'Health');
            const currentHealth = parseInt(defenderHealth.innerText);

            if (currentHealth > 0) {
                const damage = turnOrder.find(c => c.id === attackerId).prepared ? 20 : 10; // –£—Ä–æ–Ω
                const newHealth = currentHealth - damage;
                defenderHealth.innerText = newHealth < 0 ? 0 : newHealth;

                const defenderElement = document.getElementById(defenderId);
                defenderElement.style.transform = 'translateY(-10px)';
                setTimeout(() => {
                    defenderElement.style.transform = 'translateY(0)';
                }, 100);
                if (turnOrder.find(c => c.id === defenderId).isPlayer) {
                    handlePlayerDamage(defenderId, newHealth); 
                } else if (newHealth <= 0) { 
                    handleEnemyDeath(defenderId); // –£–±–∏—Ä–∞–µ–º –≤—Ä–∞–≥–∞ —Å—Ä–∞–∑—É –ø—Ä–∏ 0 —Ö–ø
                }
            }
        }

        function handlePlayerDamage(playerId, newHealth) {
            const player = turnOrder.find(c => c.id === playerId);
            if (newHealth <= 0) {
                const chanceToDie = Math.random() < 0.5; // 50% —à–∞–Ω—Å —Å–º–µ—Ä—Ç–∏
                if (chanceToDie) {
                    player.isDead = true; 
                    document.getElementById(playerId).style.opacity = 0.5; // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞–∫ –º—ë—Ä—Ç–≤–æ–≥–æ
                    document.getElementById(playerId).querySelector("h4").innerText += " üíÄ"; // –î–æ–±–∞–≤–ª—è–µ–º —á–µ—Ä–µ–ø–æ–∫
                }
            }
        }

        function handleEnemyDeath(enemyId) {
            const enemy = turnOrder.find(c => c.id === enemyId);
            enemy.isDead = true; 
            document.getElementById(enemyId).style.opacity = 0.5; // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞–∫ –º—ë—Ä—Ç–≤–æ–≥–æ
            document.getElementById(enemyId).querySelector("h4").innerText += " üíÄ"; // –î–æ–±–∞–≤–ª—è–µ–º —á–µ—Ä–µ–ø–æ–∫
        }

        function nextTurn() {
            currentTurnIndex = (currentTurnIndex + 1) % turnOrder.length; // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∏–Ω–¥–µ–∫—Å—É
            if (currentTurnIndex === 0) {
                round++;
                document.getElementById("roundCounter").innerText = '–†–∞—É–Ω–¥: ' + round; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞—É–Ω–¥ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
                resetCharacters(); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–∞—É–Ω–¥–∞
            }
            highlightCurrentTurn(); // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É —Ç–µ–∫—É—â–µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
            document.getElementById('attackButton').style.display = 'block'; 
            document.getElementById('provokeButton').style.display = 'block'; 
            document.getElementById('prepareButton').style.display = 'block'; 
            selectedTarget = null; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ü–µ–ª—å
        }

        function resetCharacters() {
            turnOrder.forEach(character => {
                if (!character.isDead) {
                    character.speed = Math.floor(Math.random() * 6) + 1; // –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –Ω–æ–≤—É—é —Å–∫–æ—Ä–æ—Å—Ç—å
                    document.getElementById(character.id + 'Speed').innerText = character.speed; // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å
                }
                character.prepared = false; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏
            });
            calculateTurnOrder(); // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–æ—Ä—è–¥–æ–∫ —Ö–æ–¥–æ–≤ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ä–∞—É–Ω–¥–∞
        }
    </script>
</body>
</html>
